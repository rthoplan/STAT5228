<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Power Query: Minimum Cleaning Checklist</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@400;700&family=Plus+Jakarta+Sans:wght@400;600;800&display=swap');
        
        body { 
            font-family: 'Plus Jakarta Sans', sans-serif; 
            background-color: #f8fafc;
        }
        .mono { font-family: 'JetBrains Mono', monospace; }
        
        .step-active {
            border-left: 4px solid #7c3aed;
            background: white;
            box-shadow: 0 4px 12px rgba(0,0,0,0.05);
        }

        .data-cell {
            transition: all 0.5s ease;
        }

        .broken-indicator {
            animation: pulse 2s infinite;
        }

        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.4; }
        }
    </style>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect } = React;

        const Icons = {
            Refresh: () => <svg className="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path strokeLinecap="round" strokeLinejoin="round" strokeWidth="2" d="M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15" /></svg>,
            Alert: () => <svg className="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path strokeLinecap="round" strokeLinejoin="round" strokeWidth="2" d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z" /></svg>,
            Check: () => <svg className="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path strokeLinecap="round" strokeLinejoin="round" strokeWidth="2" d="M5 13l4 4L19 7" /></svg>
        };

        const App = () => {
            const [completedSteps, setCompletedSteps] = useState([]);
            
            const steps = [
                {
                    id: 'rename',
                    title: "Rename messy columns",
                    description: "Replace generic names like 'Column1' or 'ATTR_9' with business terms like 'Sale Date' or 'Store Location'.",
                    impact: "Makes DAX formulas readable and visual fields self-explanatory."
                },
                {
                    id: 'types',
                    title: "Set correct data types",
                    description: "Change 'General' to specific types: Date, Decimal Number, or Text.",
                    impact: "CRITICAL: Wrong types lead to broken time intelligence and incorrect sums.",
                    isCritical: true
                },
                {
                    id: 'remove',
                    title: "Remove empty/irrelevant columns",
                    description: "Delete 'Notes_Internal', 'EmptyColumn_3', or redundant IDs.",
                    impact: "Reduces file size and speeds up report performance significantly."
                },
                {
                    id: 'split',
                    title: "Split columns if needed",
                    description: "Separate combined data like 'London, UK' or 'PROD-123-BLUE' into distinct columns.",
                    impact: "Allows users to filter by specific attributes (e.g., just 'Country' or 'Color')."
                }
            ];

            const toggleStep = (id) => {
                setCompletedSteps(prev => 
                    prev.includes(id) ? prev.filter(s => s !== id) : [...prev, id]
                );
            };

            const isDone = (id) => completedSteps.includes(id);

            // Mock Data States
            const getHeader = (id, base) => isDone('rename') ? base : id;
            const formatVal = (val, type) => {
                if (isDone('types')) return val;
                return <span className="text-red-500 italic broken-indicator">"{val}"</span>;
            };

            return (
                <div className="min-h-screen py-12 px-4 max-w-6xl mx-auto">
                    <header className="mb-12">
                        <span className="text-purple-600 font-extrabold tracking-widest text-sm uppercase">Stage 02: Power Query</span>
                        <h1 className="text-4xl font-extrabold text-slate-900 mt-2">The Cleaning Checklist</h1>
                        <p className="text-slate-500 mt-2 text-lg">Never load raw data directly into your model. Follow these 4 essential steps.</p>
                    </header>

                    <div className="grid lg:grid-cols-2 gap-12 items-start">
                        {/* LEFT: Checklist */}
                        <div className="space-y-4">
                            {steps.map((step) => (
                                <div 
                                    key={step.id}
                                    onClick={() => toggleStep(step.id)}
                                    className={`p-6 rounded-2xl cursor-pointer transition-all border-2 ${
                                        isDone(step.id) 
                                        ? 'bg-white border-green-500' 
                                        : 'bg-white border-transparent shadow-sm hover:border-purple-200'
                                    } ${!isDone(step.id) && completedSteps.length === steps.indexOf(step) ? 'ring-2 ring-purple-500 ring-offset-2' : ''}`}
                                >
                                    <div className="flex items-start gap-4">
                                        <div className={`mt-1 w-6 h-6 rounded-md border-2 flex items-center justify-center shrink-0 ${
                                            isDone(step.id) ? 'bg-green-500 border-green-500 text-white' : 'border-slate-300'
                                        }`}>
                                            {isDone(step.id) && <Icons.Check />}
                                        </div>
                                        <div>
                                            <h3 className={`text-lg font-bold ${isDone(step.id) ? 'text-slate-400 line-through' : 'text-slate-900'}`}>
                                                {step.title}
                                            </h3>
                                            {!isDone(step.id) && (
                                                <div className="mt-2 space-y-3">
                                                    <p className="text-slate-600 text-sm">{step.description}</p>
                                                    <div className={`p-3 rounded-lg text-xs font-semibold ${step.isCritical ? 'bg-red-50 text-red-700 border border-red-100' : 'bg-slate-50 text-slate-600'}`}>
                                                        <span className="uppercase mr-2 tracking-tighter opacity-70">Impact:</span>
                                                        {step.impact}
                                                    </div>
                                                </div>
                                            )}
                                        </div>
                                    </div>
                                </div>
                            ))}
                            
                            <div className="p-6 bg-amber-50 rounded-2xl border border-amber-200 flex gap-4">
                                <div className="text-amber-600 shrink-0"><Icons.Alert /></div>
                                <p className="text-amber-800 text-sm font-medium">
                                    <strong>Speaker Note:</strong> If you skip "Set Data Types," Power BI treats numbers as text. You won't be able to Sum them, and your Time visuals (Year/Month) will display alphabetically instead of chronologically!
                                </p>
                            </div>
                        </div>

                        {/* RIGHT: Live Data Preview Simulator */}
                        <div className="sticky top-8">
                            <div className="bg-slate-900 rounded-3xl p-1 shadow-2xl overflow-hidden">
                                <div className="bg-slate-800 px-6 py-4 flex justify-between items-center">
                                    <div className="flex gap-2">
                                        <div className="w-3 h-3 rounded-full bg-red-500"></div>
                                        <div className="w-3 h-3 rounded-full bg-yellow-500"></div>
                                        <div className="w-3 h-3 rounded-full bg-green-500"></div>
                                    </div>
                                    <span className="text-slate-400 text-xs font-mono uppercase tracking-widest">Power Query Editor Preview</span>
                                    <button 
                                        onClick={() => setCompletedSteps([])}
                                        className="text-slate-400 hover:text-white"
                                    >
                                        <Icons.Refresh />
                                    </button>
                                </div>
                                
                                <div className="p-4 overflow-x-auto bg-slate-900">
                                    <table className="w-full text-left border-collapse min-w-[500px]">
                                        <thead>
                                            <tr className="border-b border-slate-700">
                                                <th className="p-3 text-slate-500 text-[10px] font-mono uppercase">
                                                    {isDone('types') ? 'ðŸ“… Date' : 'ABC Text'}
                                                    <div className="text-white text-sm mt-1">{getHeader('Col_001', 'Sale Date')}</div>
                                                </th>
                                                <th className="p-3 text-slate-500 text-[10px] font-mono uppercase">
                                                    {isDone('types') ? '1.2 Dec' : 'ABC Text'}
                                                    <div className="text-white text-sm mt-1">{getHeader('Col_002', 'Revenue')}</div>
                                                </th>
                                                <th className="p-3 text-slate-500 text-[10px] font-mono uppercase">
                                                    {isDone('types') ? 'ABC Text' : 'ABC Text'}
                                                    <div className="text-white text-sm mt-1">
                                                        {isDone('split') ? 'City' : getHeader('Col_003', 'Location')}
                                                    </div>
                                                </th>
                                                {isDone('split') && (
                                                    <th className="p-3 text-slate-500 text-[10px] font-mono uppercase">
                                                        ABC Text
                                                        <div className="text-white text-sm mt-1">Country</div>
                                                    </th>
                                                )}
                                                {!isDone('remove') && (
                                                    <th className="p-3 text-slate-400/30 text-[10px] font-mono uppercase italic">
                                                        ...Irrelevant
                                                        <div className="text-slate-600 text-sm mt-1">Internal_ID</div>
                                                    </th>
                                                )}
                                            </tr>
                                        </thead>
                                        <tbody className="text-slate-300 font-mono text-sm">
                                            {[
                                                { d: "2023-01-15", r: "1200.50", l: "Paris, France", id: "XJ-99" },
                                                { d: "2023-02-10", r: "850.00", l: "London, UK", id: "BK-22" },
                                                { d: "2023-03-05", r: "2100.99", l: "New York, USA", id: "LP-11" }
                                            ].map((row, i) => (
                                                <tr key={i} className="border-b border-slate-800 hover:bg-slate-800/50">
                                                    <td className="p-3 whitespace-nowrap">{formatVal(row.d)}</td>
                                                    <td className="p-3 whitespace-nowrap">{formatVal(row.r)}</td>
                                                    <td className="p-3 whitespace-nowrap">
                                                        {isDone('split') ? row.l.split(', ')[0] : row.l}
                                                    </td>
                                                    {isDone('split') && <td className="p-3 text-purple-400">{row.l.split(', ')[1]}</td>}
                                                    {!isDone('remove') && <td className="p-3 text-slate-700">{row.id}</td>}
                                                </tr>
                                            ))}
                                        </tbody>
                                    </table>
                                </div>
                                
                                <div className="bg-slate-800/50 p-6">
                                    <h4 className="text-white text-sm font-bold mb-3 flex items-center gap-2">
                                        Visual Result: 
                                        {completedSteps.length === steps.length ? 
                                            <span className="text-green-400 flex items-center gap-1"><Icons.Check /> Perfect</span> : 
                                            <span className="text-red-400 flex items-center gap-1"><Icons.Alert /> Issues Detected</span>
                                        }
                                    </h4>
                                    
                                    <div className="flex items-end gap-2 h-32">
                                        {isDone('types') ? (
                                            <>
                                                <div className="flex-1 bg-purple-500 rounded-t-lg h-[40%] relative group">
                                                    <div className="absolute -top-6 left-1/2 -translate-x-1/2 text-[10px] text-slate-400">Jan</div>
                                                </div>
                                                <div className="flex-1 bg-purple-500 rounded-t-lg h-[30%] relative">
                                                    <div className="absolute -top-6 left-1/2 -translate-x-1/2 text-[10px] text-slate-400">Feb</div>
                                                </div>
                                                <div className="flex-1 bg-purple-500 rounded-t-lg h-[80%] relative">
                                                    <div className="absolute -top-6 left-1/2 -translate-x-1/2 text-[10px] text-slate-400">Mar</div>
                                                </div>
                                            </>
                                        ) : (
                                            <div className="w-full h-full flex items-center justify-center bg-slate-900/50 rounded-xl border border-dashed border-slate-700 text-slate-500 text-xs text-center px-4">
                                                Visual Broken: Cannot aggregate text values or sort dates alphabetically.
                                            </div>
                                        )}
                                    </div>
                                </div>
                            </div>
                            
                            <p className="text-center text-slate-400 text-xs mt-4 italic">
                                Click the checklist items on the left to "apply" the transformation.
                            </p>
                        </div>
                    </div>
                </div>
            );
        };

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
</body>
</html>
